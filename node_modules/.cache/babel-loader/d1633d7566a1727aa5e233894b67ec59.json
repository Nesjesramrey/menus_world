{"ast":null,"code":"var _jsxFileName = \"/home/nesramblue/Nestor/Kodemia/menus_world/src/components/AddComment/index.jsx\",\n    _s = $RefreshSig$();\n\nimport \"./AddComment.css\";\nimport { useState } from \"react\";\nimport { Rating } from \"react-simple-star-rating\";\nimport { createComment as sendComment } from \"../../services/menus\"; //Cookies\n\nimport Cookies from \"universal-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AddComment(id, alredyCommented) {\n  _s();\n\n  const [canComment, setCanComment] = useState(false); //state\n\n  const [text, setText] = useState(\"\");\n  const [existComment, setExistComment] = useState(true); //value of rating\n\n  const [ratingValue, setRatingValue] = useState(0); // add usertype, ID and username\n\n  const cookies = new Cookies();\n  const userType = cookies.get(\"TipoUsuario\");\n  const userId = cookies.get(\"Id\");\n  const userName = cookies.get(\"Usuario\");\n\n  const handleRating = rate => setRatingValue(rate / 20);\n\n  const sendData = () => {\n    let today = new Date();\n    const data = {\n      user: userName,\n      rating: ratingValue,\n      comment: text,\n      idUser: userId,\n      date: today\n    };\n    console.log(data);\n    const Url = \"https://menus.api.nesjes.com/detalle/\" + id;\n    fetch(Url, {\n      method: \"PATCH\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    }).then(response => response.json()).then(data => {\n      console.log(\"Success:\", data);\n    }).catch(error => {\n      console.error(\"Error:\", error);\n    });\n  };\n\n  const addNewcomment = msg => {\n    console.log(msg.length);\n    console.log(ratingValue); //not logIn\n\n    if (!userName) {\n      console.error(\"Para agregar comentarios debes iniciar sesión\");\n    } else {\n      //Is logIn\n      if (userType === \"Comensal\") {\n        //only user can add comments\n        if (alredyCommented === false && msg.length > 0 && ratingValue > 0) {\n          console.log(msg.length);\n          console.log(ratingValue);\n          setCanComment(false);\n          setText(msg);\n          sendData();\n        }\n      } else {\n        //admins can't comment\n        console.error(\"No se puede agregar comentarios con sesión de administrador\");\n      }\n    } // window.location.reload(false); // - - - - - - - - - - - -  reload only when all succes ok\n\n  };\n\n  function createContent() {\n    if (canComment === false) {\n      if (alredyCommented) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Ya has comentado este platillo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"addComment\",\n          type: \"button\",\n          onClick: () => setCanComment(true),\n          children: \"Agrega un comentario\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 9\n        }, this);\n      } // <button\n      //   id=\"addComment\"\n      //   type=\"button\"\n      //   onClick={() => setCanComment(true)}\n      // >\n      //   Agrega un comentario\n      // </button>\n\n    }\n\n    if (canComment === true) {\n      return /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"formAddComment\",\n        action: \"/action_page.php\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"textInstructions\",\n          children: \"Escribe un comentario sobre el platillo y deja tu puntuaci\\xF3n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          id: \"addNewComment\",\n          name: \"newComment\",\n          placeholder: \"Escribe tu rese\\xF1a del platillo\",\n          onChange: e => setText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Rating, {\n          transition: true,\n          onClick: handleRating,\n          ratingValue: ratingValue,\n          fillColor: \"#ffd700\",\n          emptyColor: \"#888888\",\n          size: 50\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"addComment\",\n          type: \"button\",\n          onClick: e => addNewcomment(text),\n          children: \"Enviar comentario\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"addCommentSection\",\n    children: createContent()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 10\n  }, this);\n}\n\n_s(AddComment, \"KcF2L7CcoJqYemNTqtHJYbUaLbc=\");\n\n_c = AddComment;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddComment\");","map":{"version":3,"names":["useState","Rating","createComment","sendComment","Cookies","AddComment","id","alredyCommented","canComment","setCanComment","text","setText","existComment","setExistComment","ratingValue","setRatingValue","cookies","userType","get","userId","userName","handleRating","rate","sendData","today","Date","data","user","rating","comment","idUser","date","console","log","Url","fetch","method","headers","body","JSON","stringify","then","response","json","catch","error","addNewcomment","msg","length","createContent","e","target","value"],"sources":["/home/nesramblue/Nestor/Kodemia/menus_world/src/components/AddComment/index.jsx"],"sourcesContent":["import \"./AddComment.css\";\r\nimport { useState } from \"react\";\r\nimport { Rating } from \"react-simple-star-rating\";\r\nimport { createComment as sendComment } from \"../../services/menus\";\r\n\r\n//Cookies\r\nimport Cookies from \"universal-cookie\";\r\n\r\nexport default function AddComment(id,alredyCommented) {\r\n  const [canComment, setCanComment] = useState(false); //state\r\n  const [text, setText] = useState(\"\");\r\n  const [existComment, setExistComment] = useState(true);\r\n\r\n    //value of rating\r\n    const [ratingValue, setRatingValue] = useState(0);\r\n\r\n  // add usertype, ID and username\r\n  const cookies = new Cookies();\r\n  const userType = cookies.get(\"TipoUsuario\");\r\n  const userId = cookies.get(\"Id\");\r\n  const userName = cookies.get(\"Usuario\");\r\n\r\n  const handleRating = (rate) => setRatingValue(rate / 20);\r\n\r\n  const sendData = () => {\r\n    let today = new Date();\r\n\r\n    const data = {\r\n      user: userName,\r\n      rating: ratingValue,\r\n      comment: text,\r\n      idUser: userId,\r\n      date: today,\r\n    };\r\n    console.log(data);\r\n    const Url = \"https://menus.api.nesjes.com/detalle/\" + id;\r\n\r\n    fetch(Url, {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    })\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        console.log(\"Success:\", data);\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error:\", error);\r\n      });\r\n  };\r\n\r\n  const addNewcomment = (msg) => {\r\n    console.log(msg.length)\r\n    console.log(ratingValue)\r\n\r\n\r\n    //not logIn\r\n    if (!userName) {\r\n      console.error(\"Para agregar comentarios debes iniciar sesión\");\r\n    } else {\r\n      //Is logIn\r\n      if (userType === \"Comensal\") {\r\n        //only user can add comments\r\n        if(alredyCommented === false && msg.length > 0 && ratingValue > 0){\r\n          console.log(msg.length)\r\n          console.log(ratingValue)\r\n          \r\n          setCanComment(false);\r\n          setText(msg);\r\n          sendData();\r\n        } \r\n      } else {\r\n        //admins can't comment\r\n        console.error(\r\n          \"No se puede agregar comentarios con sesión de administrador\"\r\n        );\r\n      }\r\n    }\r\n   // window.location.reload(false); // - - - - - - - - - - - -  reload only when all succes ok\r\n  };\r\n\r\n\r\n  function createContent() {\r\n    if (canComment === false) {\r\n      if (alredyCommented){\r\n        return (\r\n          <p>Ya has comentado este platillo</p>\r\n        )\r\n\r\n      } else {\r\n        return(\r\n        <button\r\n          id=\"addComment\"\r\n          type=\"button\"\r\n          onClick={() => setCanComment(true)}\r\n        >\r\n          Agrega un comentario\r\n        </button>\r\n        )\r\n      }\r\n\r\n\r\n\r\n\r\n\r\n        // <button\r\n        //   id=\"addComment\"\r\n        //   type=\"button\"\r\n        //   onClick={() => setCanComment(true)}\r\n        // >\r\n        //   Agrega un comentario\r\n        // </button>\r\n      \r\n    }\r\n    if (canComment === true) {\r\n      return (\r\n        <form id=\"formAddComment\" action=\"/action_page.php\">\r\n          <p id=\"textInstructions\">\r\n            Escribe un comentario sobre el platillo y deja tu puntuación\r\n          </p>\r\n          <textarea\r\n            id=\"addNewComment\"\r\n            name=\"newComment\"\r\n            placeholder=\"Escribe tu reseña del platillo\"\r\n            onChange={(e) => setText(e.target.value)}\r\n          ></textarea>\r\n          <Rating\r\n            transition\r\n            onClick={handleRating}\r\n            ratingValue={ratingValue}\r\n            fillColor={\"#ffd700\"}\r\n            emptyColor={\"#888888\"}\r\n            size={50}\r\n          />\r\n          <button\r\n            id=\"addComment\"\r\n            type=\"button\"\r\n            onClick={(e) => addNewcomment(text)}\r\n          >\r\n            Enviar comentario\r\n          </button>\r\n        </form>\r\n      );\r\n    }\r\n  }\r\n\r\n  return <div id=\"addCommentSection\">{createContent()}</div>;\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}