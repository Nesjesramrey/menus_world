{"ast":null,"code":"var _jsxFileName = \"/home/nesramblue/Nestor/Kodemia/menus_world/src/components/AddComment/index.jsx\",\n    _s = $RefreshSig$();\n\nimport './AddComment.css';\nimport { useState } from 'react';\nimport { Rating } from 'react-simple-star-rating'; //import { createComment as sendComment } from '../../services/menus';\n//Cookies\n\nimport Cookies from 'universal-cookie'; // Toastify\n\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AddComment(id, alredyCommented) {\n  _s();\n\n  const [canComment, setCanComment] = useState(false); //state\n\n  const [text, setText] = useState(''); //const [existComment, setExistComment] = useState(true);\n  //value of rating\n\n  const [ratingValue, setRatingValue] = useState(0); // add usertype, ID and username\n\n  const cookies = new Cookies();\n  const userType = cookies.get('TipoUsuario');\n  const userId = cookies.get('Id');\n  const userName = cookies.get('Usuario');\n\n  const handleRating = rate => setRatingValue(rate / 20);\n\n  const sendData = () => {\n    let today = new Date();\n    const data = {\n      user: userName,\n      rating: ratingValue,\n      comment: text,\n      idUser: userId,\n      date: today\n    };\n    const Url = 'https://menus.api.nesjes.com/detalle/' + id;\n    fetch(Url, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    }).then(response => response.json()).then(data => {}).catch(error => {});\n  };\n\n  const addNewcomment = msg => {\n    //not logIn\n    if (!userName) {\n      toast.error('Para agregar comentarios debes iniciar sesión');\n    } else {\n      //Is logIn\n      if (userType === 'Comensal') {\n        //only user can add comments\n        if (alredyCommented === false && msg.length > 0 && ratingValue > 0) {\n          setCanComment(false);\n          setText(msg);\n          sendData();\n          window.location.reload(false); // - - - - - - - - - - - -  reload only when all succes ok\n        } else {\n          toast.error('Debes agregar una reseña y calificación');\n        }\n      } else {\n        //admins can't comment\n        toast.error('No se puede agregar comentarios con sesión de administrador');\n      }\n    }\n  };\n\n  function createContent() {\n    if (canComment === false) {\n      if (alredyCommented) {\n        return /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Ya has comentado este platillo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 12\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"addComment\",\n          type: \"button\",\n          onClick: () => setCanComment(true),\n          children: \"Agrega un comentario\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 6\n        }, this);\n      }\n    }\n\n    if (canComment === true) {\n      return /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"formAddComment\",\n        action: \"/action_page.php\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"textInstructions\",\n          children: /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Escribe un comentario sobre el platillo y deja tu puntuaci\\xF3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 31\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          id: \"addNewComment\",\n          name: \"newComment\",\n          placeholder: \"Escribe tu rese\\xF1a del platillo\",\n          onChange: e => setText(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(Rating, {\n          transition: true,\n          onClick: handleRating,\n          ratingValue: ratingValue,\n          fillColor: '#ffd700',\n          emptyColor: '#888888',\n          size: 50\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"addComment\",\n          type: \"button\",\n          onClick: e => addNewcomment(text),\n          children: \"Enviar comentario\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 5\n      }, this);\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"addCommentSection\",\n    children: [createContent(), /*#__PURE__*/_jsxDEV(ToastContainer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 3\n  }, this);\n}\n\n_s(AddComment, \"F0oBL7j+Y01dSoHRRO0Oqhe/kz4=\");\n\n_c = AddComment;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddComment\");","map":{"version":3,"names":["useState","Rating","Cookies","ToastContainer","toast","AddComment","id","alredyCommented","canComment","setCanComment","text","setText","ratingValue","setRatingValue","cookies","userType","get","userId","userName","handleRating","rate","sendData","today","Date","data","user","rating","comment","idUser","date","Url","fetch","method","headers","body","JSON","stringify","then","response","json","catch","error","addNewcomment","msg","length","window","location","reload","createContent","e","target","value"],"sources":["/home/nesramblue/Nestor/Kodemia/menus_world/src/components/AddComment/index.jsx"],"sourcesContent":["import './AddComment.css';\r\nimport { useState } from 'react';\r\nimport { Rating } from 'react-simple-star-rating';\r\n//import { createComment as sendComment } from '../../services/menus';\r\n\r\n//Cookies\r\nimport Cookies from 'universal-cookie';\r\n\r\n// Toastify\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\n\r\nexport default function AddComment(id, alredyCommented) {\r\n\tconst [canComment, setCanComment] = useState(false); //state\r\n\tconst [text, setText] = useState('');\r\n\t//const [existComment, setExistComment] = useState(true);\r\n\r\n\t//value of rating\r\n\tconst [ratingValue, setRatingValue] = useState(0);\r\n\r\n\t// add usertype, ID and username\r\n\tconst cookies = new Cookies();\r\n\tconst userType = cookies.get('TipoUsuario');\r\n\tconst userId = cookies.get('Id');\r\n\tconst userName = cookies.get('Usuario');\r\n\r\n\tconst handleRating = (rate) => setRatingValue(rate / 20);\r\n\r\n\tconst sendData = () => {\r\n\t\tlet today = new Date();\r\n\r\n\t\tconst data = {\r\n\t\t\tuser: userName,\r\n\t\t\trating: ratingValue,\r\n\t\t\tcomment: text,\r\n\t\t\tidUser: userId,\r\n\t\t\tdate: today,\r\n\t\t};\r\n\t\tconst Url = 'https://menus.api.nesjes.com/detalle/' + id;\r\n\r\n\t\tfetch(Url, {\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: JSON.stringify(data),\r\n\t\t})\r\n\t\t\t.then((response) => response.json())\r\n\t\t\t.then((data) => {})\r\n\t\t\t.catch((error) => {});\r\n\t};\r\n\r\n\tconst addNewcomment = (msg) => {\r\n\t\t//not logIn\r\n\t\tif (!userName) {\r\n\t\t\ttoast.error('Para agregar comentarios debes iniciar sesión');\r\n\t\t} else {\r\n\t\t\t//Is logIn\r\n\t\t\tif (userType === 'Comensal') {\r\n\t\t\t\t//only user can add comments\r\n\t\t\t\tif (alredyCommented === false && msg.length > 0 && ratingValue > 0) {\r\n\t\t\t\t\tsetCanComment(false);\r\n\t\t\t\t\tsetText(msg);\r\n\t\t\t\t\tsendData();\r\n          window.location.reload(false); // - - - - - - - - - - - -  reload only when all succes ok\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error('Debes agregar una reseña y calificación');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t//admins can't comment\r\n\t\t\t\ttoast.error('No se puede agregar comentarios con sesión de administrador');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tfunction createContent() {\r\n\t\tif (canComment === false) {\r\n\t\t\tif (alredyCommented) {\r\n\t\t\t\treturn <p><h5>Ya has comentado este platillo</h5></p>;\r\n\t\t\t} else {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<button id=\"addComment\" type=\"button\" onClick={() => setCanComment(true)}>\r\n\t\t\t\t\t\tAgrega un comentario\r\n\t\t\t\t\t</button>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (canComment === true) {\r\n\t\t\treturn (\r\n\t\t\t\t<form id=\"formAddComment\" action=\"/action_page.php\">\r\n\t\t\t\t\t<p id=\"textInstructions\"><h5>Escribe un comentario sobre el platillo y deja tu puntuación</h5></p>\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tid=\"addNewComment\"\r\n\t\t\t\t\t\tname=\"newComment\"\r\n\t\t\t\t\t\tplaceholder=\"Escribe tu reseña del platillo\"\r\n\t\t\t\t\t\tonChange={(e) => setText(e.target.value)}\r\n\t\t\t\t\t></textarea>\r\n\t\t\t\t\t<Rating\r\n\t\t\t\t\t\ttransition\r\n\t\t\t\t\t\tonClick={handleRating}\r\n\t\t\t\t\t\tratingValue={ratingValue}\r\n\t\t\t\t\t\tfillColor={'#ffd700'}\r\n\t\t\t\t\t\temptyColor={'#888888'}\r\n\t\t\t\t\t\tsize={50}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<button id=\"addComment\" type=\"button\" onClick={(e) => addNewcomment(text)}>\r\n\t\t\t\t\t\tEnviar comentario\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</form>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div id=\"addCommentSection\">\r\n\t\t\t{createContent()}\r\n\t\t\t<ToastContainer />\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}